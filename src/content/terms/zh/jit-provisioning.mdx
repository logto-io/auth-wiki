---
title: 即时供应 (JIT) 供应 (Just-in-time provisioning)
tags: [authentication, authorization]
description: 即时供应 (JIT) 供应是一个身份和访问管理 (IAM) 过程，当用户首次尝试访问系统或应用程序时，用户账户动态自动创建。此方法有助于简化入职流程，并确保仅在需要时创建用户账户，从而降低管理开销并提高安全性。
---

## 什么是即时供应 (JIT) 供应？

如果你正在构建一个 SaaS B2B 应用程序，并希望支持会员功能，允许成员轻松加入你的工作空间（租户）。你可能需要下表中的功能，而即时供应是其中之一，有助于隐式流程。

| 功能 | 流程 |
| --- | --- |
| 管理员发起邀请 | 用户可以收到加入组织的电子邮件邀请。 |
| 通过 API 创建或导入用户 | 用户可以使用预先创建的用户账户加入组织。 |
| 即时供应 | 首次登录应用程序的用户可以加入组织。 |
| 目录同步（例如 SCIM） | 使用 IdP 的目录同步功能提前在应用中预先供应用户。 |

**即时供应 (JIT) 供应** 是一种在身份和访问管理系统中使用的过程，用于在用户首次登录系统时动态创建用户账户。与提前预先供应用户账户不同，JIT 供应在用户认证 (Authentication) 时动态创建和配置必要的用户账户。即时供应是一种流行的功能，其特点包括效率高、不需要行政参与、自动组织成员资格等。

## 即时供应的应用场景是什么？

这些场景在构建涉及多租户架构、企业 SSO (Enterprise SSO)、与企业合作或需要团队入职功能的 B2B 应用程序时很常见。以下是一些你客户可能遇到的示例场景。

### 快速入职

你的客户需要频繁招聘或快速增长，可以使用 JIT 供应迅速为新员工设置用户账户。例如：

Sarah 是 SuperFantasy 公司的新员工，该公司使用 Okta 作为其企业身份提供商 (Identity Provider)。HR 团队只需在 Okta 中添加她的一次业务身份。当 Sarah 第一次使用这个电子邮件登录一个名为 Smartworkspace 的企业级生产力应用程序时，系统会自动为她在公司的工作空间中创建账户并分配正确的角色。这样，Sarah 和 SuperFantasy 的 HR 团队都不需要经过多个步骤来创建账户和分配角色。

### 收购、兼并和临时工

如果你的客户正在合并或收购其他公司，JIT 供应可以简化为大量新用户授予访问权限的过程。让我们来看另一个例子，

Peter 是 MagicTech 的员工，该公司最近被 SuperFantasy 收购。MagicTech 是一个较小的组织，没有企业 SSO (Enterprise SSO)，但也使用 Smartworkspace，Peter 已经拥有一个业务账户。

HR 团队可以在 Okta 中添加 Peter。当 Peter 第一次通过 Okta 登录 Smartworkspace 时，系统会自动链接他的现有业务账户，并授予他适当的访问权限给 SuperFantasy。

上述场景是实现 JIT 功能的理想场景。

## 它是否仅用于 SAML 和企业 SSO？

虽然即时供应 (JIT) 供应通常与 SAML 认证中的单点登录 (SSO) 相关联，但它并不限于 SAML。JIT 供应同样可以与其他认证协议，如 OAuth 2.0 和 OpenID Connect 搭配使用，并不总是需要企业 SSO 的设置。

例如，基于电子邮件的 JIT 供应可以通过根据用户的电子邮件域自动将他们添加到工作空间来简化团队的入职。这对于缺乏预算和资源去购买和管理企业 SSO 的组织特别有用。

JIT 供应的基本思想是在用户首次尝试访问服务时自动创建或更新用户账户，而不考虑使用的具体协议。

## 它适用于应用程序的新用户或现有用户吗？

即时供应 (JIT) 供应通常指用户首次尝试访问应用程序。然而，不同的产品对该功能有不同的理解。有些将 JIT 供应仅用于身份和账户创建，而其他则还包括即时账户更新，例如重新供应和属性同步。

除了自动创建用户，SAML JIT 供应还允许作为供应过程的一部分授予和撤销组成员资格。它也可以更新已供应的用户，使其属性在服务提供商 (SP) 存储与身份提供商 (IDP) 用户存储属性保持同步。

如果你确实想考虑后续的现有用户登录场景，请确保你有一个稳健的供应系统与 JIT 系统配合。例如，

- **冲突解决**：如果在 JIT 过程中 IdP 提供的信息与已有账户信息不同，你的系统应有策略来处理冲突。这可能需要详细控制你的组织政策和 IdP 配置。
- **审计跟踪**：为了安全和合规原因，维护通过 JIT 过程创建的新账户和更新现有账户的日志是非常重要的。
- **性能**：虽然 JIT 供应运行快速，但需要考虑其对登录时间的潜在影响，特别是当你在每次登录时更新现有用户的信息。
- **数据一致性**：确保你的 JIT 供应过程保持数据一致性，特别是在更新现有用户账户时。

## JIT 和 SCIM 的区别是什么？

SCIM 是一个开放标准协议，旨在简化和自动化跨不同系统和领域的用户身份管理。它通常用于目录同步场景。

JIT 和 SCIM 的主要区别在于，JIT 在用户尝试登录时创建账户，而 SCIM 可以通过离线自动化过程供应用户，与用户登录尝试无关。

这意味着 JIT 专注于新用户的入职，而 SCIM 专注于用户的全生命周期管理。

此外，JIT 通常是 SAML 的扩展，跨系统缺乏标准化的实现，而 SCIM 是一个定义良好的标准化协议 [RFC 7644](https://datatracker.ietf.org/doc/html/rfc7644) 用于身份管理。

一些大型组织使用 SCIM 进行账户供应，将其与自己的系统集成。这可能非常复杂，并且因案例而异。这些组织通常拥有一个涉及自动化流程和手动管理员参与的供应系统。

<Resources urls={['https://blog.logto.io/jit-provisioning']} />
